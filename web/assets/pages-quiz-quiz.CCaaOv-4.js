import{_ as t,p as o,$ as e,y as n,c as s,s as a,a as i,h as l,t as d,d as c,w as u,i as r,o as h,e as y,f as w,g as p,z as f,A as m,F as C,j as x,l as A,k as I,I as _,n as T}from"./index-Bg8HKLxi.js";function k(){const t=new Date;return`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`}const g=t({data:()=>({questions:[{text:"你觉得什么是真正的朋友",options:["两肋插刀","彼此信任","利益交换","长久陪伴"]},{text:"你觉得自己的未来迷茫吗？",options:["非常迷茫","偶尔迷茫","从不迷茫","没想过"]},{text:"你觉得未来的自己一定能成为现在所想想的自己吗？",options:["一定能","可能吧","很难说","不太可能"]},{text:"你觉得时间还够吗？",options:["完全够","抓紧就够","不太够","已经晚了"]},{text:"你觉得梦想会实现吗？",options:["一定会","努力会","看运气","不会"]},{text:"你觉得开心吗？",options:["很开心","一般","不太开心","很糟糕"]},{text:"你觉得你想要什么东西？",options:["财富","自由","爱情","健康"]},{text:"你觉得你为什么而去奔赴？",options:["家人","自己","梦想","责任"]},{text:"你觉得你可以长生吗？",options:["可以","不可能","活在记忆中","精神永生"]}],currentIndex:0,selectedIndex:null,lastAdTime:0,alipayAccount:"",adSdkReady:!1,hasAgreed:!0,cooldown:90,todayCount:0,lastAnswerTime:0,remainCooldown:0,cooldownTimer:null,userPoints:0}),onLoad(){this.userPoints=o("userPoints")||0;const t=o("lastRewardAdTime");this.lastAdTime=t||0;const n=o("userInfo");n&&n.alipayAccount&&(this.alipayAccount=n.alipayAccount),this.initTodayCount(),this.startCooldownTimer(),e("adSdkReady",(()=>{this.adSdkReady=!0}))},onUnload(){n("adSdkReady"),clearInterval(this.cooldownTimer)},methods:{initTodayCount(){const t=k(),e=o("lastAnswerDate")||"",n=o("todayAnswerCount")||0;e!==t?(this.todayCount=0,s("todayAnswerCount",0),s("lastAnswerDate",t)):this.todayCount=n},startCooldownTimer(){this.calcRemainCooldown(),this.cooldownTimer=setInterval((()=>{this.calcRemainCooldown()}),1e3)},calcRemainCooldown(){const t=Date.now(),o=this.lastAnswerTime;if(0===o)return void(this.remainCooldown=0);const e=Math.floor((t-o)/1e3);this.remainCooldown=Math.max(0,this.cooldown-e)},addTodayCount(){this.todayCount+=1,s("todayAnswerCount",this.todayCount),s("lastAnswerDate",k())},safeCallAdMethod:(t,...o)=>"undefined"!=typeof window&&window[t]?window[t](...o):null,nextQuestion(){null!==this.selectedIndex?this.todayCount>=50?a({title:"今日答题次数已达上限",icon:"none"}):this.remainCooldown>0?a({title:`冷却中，还需${this.remainCooldown}秒`,icon:"none"}):this.showRewardVideoThenNext():a({title:"请选择一个选项",icon:"none"})},async showRewardVideoThenNext(){const t=(o("userInfo")||{})._id||"test_user";this.adSdkReady&&"undefined"!=typeof window?(i({title:"广告加载中..."}),this.safeCallAdMethod("loadPlayRewardVideo",t),window.callBack4=async t=>{if(2==t.code){l();const n=t.amount||0,i=o("userInfo")||{},c=i._id||"test_user";try{const t=await d.callFunction({name:"addPoints",data:{userId:c,amount:n}});if(0===t.result.code){const o=t.result.money;this.userPoints+=o,s("userPoints",this.userPoints),i.points=(i.points||0)+o,s("userInfo",i),a({title:`获得 ${o} 金币`,icon:"success"})}}catch(e){console.log("发放金币异常",e)}this.safeCallAdMethod("loadInteraction"),this.goToNextQuestion()}0==t.code&&(l(),a({title:"广告加载失败，直接进入下一题",icon:"none"}),this.goToNextQuestion())}):this.goToNextQuestion()},goToNextQuestion(){this.lastAnswerTime=Date.now(),this.addTodayCount(),this.currentIndex++,this.selectedIndex=null},async saveAlipayAccount(){const t=o("userInfo");if(t&&t._id)if(this.alipayAccount)try{0===(await d.callFunction({name:"updateUserInfo",data:{alipayAccount:this.alipayAccount,userId:t._id}})).result.code&&(a({title:"保存成功"}),t.alipayAccount=this.alipayAccount,s("userInfo",t))}catch(e){a({title:"保存失败",icon:"none"})}else a({title:"请输入支付宝账号",icon:"none"});else a({title:"请先登录",icon:"none"})}}},[["render",function(t,o,e,n,s,a){const i=r,l=A,d=I,k=_;return h(),c(i,{class:"quiz-container"},{default:u((()=>[y(i,{class:"top-tip"},{default:u((()=>[w(" 以下答题内容是作者自己的话请各位莫要当真就当是作者的一时兴起吧！ ")])),_:1}),y(i,{class:"top-row"},{default:u((()=>[y(i,{class:"coin-display"},{default:u((()=>[w(" 金币: "+p(s.userPoints),1)])),_:1}),y(i,{class:"progress"},{default:u((()=>[w(" 今日答题："+p(s.todayCount)+"/50 题 ",1)])),_:1})])),_:1}),s.currentIndex<s.questions.length?(h(),c(i,{key:0,class:"question-card"},{default:u((()=>[y(i,{class:"question-title"},{default:u((()=>[w(p(s.currentIndex+1)+"、"+p(s.questions[s.currentIndex].text),1)])),_:1}),y(i,{class:"options-list"},{default:u((()=>[(h(!0),f(C,null,m(s.questions[s.currentIndex].options,((t,o)=>(h(),c(i,{key:o,class:T(["option-item",{active:s.selectedIndex===o}]),onClick:t=>s.selectedIndex=o},{default:u((()=>[y(l,{class:"option-label"},{default:u((()=>[w(p(String.fromCharCode(65+o))+".",1)])),_:2},1024),y(l,{class:"option-text"},{default:u((()=>[w(p(t),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1}),s.currentIndex<s.questions.length?(h(),c(d,{key:0,class:"next-btn",onClick:a.nextQuestion,disabled:s.remainCooldown>0||s.todayCount>=50},{default:u((()=>[w(p(s.remainCooldown>0?`冷却中 ${s.remainCooldown}秒`:s.todayCount>=50?"今日次数已达上限":"下一题"),1)])),_:1},8,["onClick","disabled"])):x("",!0)])),_:1})):(h(),c(i,{key:1,class:"end-message"},{default:u((()=>[y(l,{class:"blessing"},{default:u((()=>[w("祝愿各位各有所成各有所得")])),_:1}),y(i,{class:"alipay-section"},{default:u((()=>[y(i,{class:"form-item"},{default:u((()=>[y(k,{modelValue:s.alipayAccount,"onUpdate:modelValue":o[0]||(o[0]=t=>s.alipayAccount=t),type:"text",placeholder:"请输入支付宝账号",class:"form-input"},null,8,["modelValue"])])),_:1}),y(d,{onClick:a.saveAlipayAccount,class:"save-btn"},{default:u((()=>[w(" 保存支付宝账号 ")])),_:1},8,["onClick"])])),_:1})])),_:1}))])),_:1})}],["__scopeId","data-v-2cac3321"]]);export{g as default};
